---
title: 20241213CTFå­¦ä¹ ç¬”è®°10
date: 2024-12-13
tags:
 - CTF
 - CTFLearn
categories:
   - å‘½ç†å­¦ Numerology
isShowComments: true
publish: true









---

<Boxx/>

ä»0å¼€å§‹å­¦ä¹ CTFï¼Œäº†è§£CTFåŸºæœ¬è§„åˆ™ã€æ–¹æ³•ï¼Œè¿™æ˜¯å¼€å§‹æ‰“å¡å­¦ä¹ çš„ç¬¬28å¤©

[[toc]]

- è§†é¢‘åœ°å€ã€[ğŸ”—ä¼ é€é—¨](https://www.bilibili.com/video/BV1Lh411F7s8/)ã€‘

<!-- more -->

# ç¬¬11ç« ï¼šå¸ƒå°”ç›²æ³¨1

## å¸ƒå°”ç›²æ³¨-å›æ˜¾ä¸åŒ

### å¸ƒå°”çŠ¶æ€ä¾‹å¦‚ï¼š

1. å›æ˜¾ä¸åŒï¼ˆæ¯”å¦‚èƒ½æŸ¥åˆ°å†…å®¹æ—¶æ˜¾ç¤ºå†…å®¹ï¼ŒæŸ¥ä¸åˆ°æ—¶ä¸æ˜¾ç¤ºå†…å®¹ã€é•¿åº¦ï¼‰
2. HTTPå“åº”çŠ¶æ€ç ä¸åŒï¼ˆ200æˆåŠŸã€500ã€301é‡å®šå‘ï¼‰
3. HTTPå“åº”å¤´å˜åŒ–ï¼ˆæ¯”å¦‚ç™»å½•æˆåŠŸï¼Œå¯èƒ½ä¼šå¸¦locationçš„è¯·æ±‚å¤´è¿›è¡Œé‡å®šå‘ï¼Œæˆ–è€…åŠ ä¸Šä¸€ä¸ªæ–°çš„cookieï¼Œå¦‚æœå¤±è´¥å°±æ²¡æœ‰ä»¥ä¸Šè¿™äº›ï¼‰
4. åŸºäºé”™è¯¯çš„å¸ƒå°”æ³¨å…¥ï¼ˆMySQLæ˜¯å¦æŠ¥é”™ï¼‰

æˆ‘ä»¬ä»æµè§ˆå™¨çœ‹åˆ°çš„å„ç§å†…å®¹çš„å˜åŒ–ã€å“åº”å¤´çš„å˜åŒ–ã€çŠ¶æ€ç çš„å˜åŒ–å®é™…åæ˜ çš„æ˜¯SQLè¯­å¥æŸ¥è¯¢çš„æˆåŠŸä¸å¦çš„å¸ƒå°”çŠ¶æ€ã€‚



### åˆæ­¥è®¤è¯†ç›²æ³¨ï¼š

```mysql
# and ä¸è¿ç®— ä¸€å‡å…¨å‡ è¿™ä¸ªè¯­å¥çš„æŸ¥è¯¢æˆåŠŸæˆåŠŸå®Œå…¨å†³å®šäºandåè¾¹1=1å’Œ1=2
select * from users where id='1' and 1=1
select * from users where id='1' and 1=2

# åŒç†æˆ‘ä»¬å¯ä»¥æ¢æˆåˆ«çš„æ¡ä»¶ æŸ¥é¦–å­—æ¯æ˜¯ä¸æ˜¯aã€bã€cç­‰
select * from users where id ='1' and substr((select database()),1,1)='a'
select * from users where id = '1' and substr((select database()),1,1)='c'
```

å…‰æœ‰é¦–å­—æ¯è¿˜ä¸å¤Ÿï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹substrçš„å‚æ•°ï¼Œæ¯”å¦‚

```
select * from users where id = '1' and substr((select database()),2,1)='a'
```

ä»¥æ­¤ç±»æ¨ã€‚ã€‚ã€‚

è®¤è¯†ç›²æ³¨ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ä»”ç»†è§‚å¯Ÿè¿™ä¸ªæ¡ä»¶

```
substr((select database()),2,1)='a'
```

ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¼•ç”³å‡ºæ¥ç›²æ³¨çš„ä¸¤ä¸ªåŸºæœ¬ç‚¹ã€ä¸¤å¤§åŸºæœ¬é—®é¢˜ï¼š



### ç›²æ³¨çš„ä¸¤å¤§åŸºç¡€é—®é¢˜

1. âœ…**å­—ç¬¦ä¸²çš„æˆªå–**
2. âœ…**æ¯”è¾ƒ**

ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œæ¯”å¦‚ç›®æ ‡åº“åæ˜¯ctfgameï¼Œæˆ‘ä»¬æˆªå–ä»¥åå†è¿›è¡Œæ¯”è¾ƒï¼Œæ€»å…±7ä¸ªå­—æ¯ï¼Œæ¯ä¸ªä½ç½®æœ‰62ç§å­—ç¬¦ï¼Œæœ€å·®çš„æƒ…å†µä¹Ÿåªéœ€è¦7*62æ¬¡å°±ä¼šå¾—å‡ºç»“æœã€‚

è€Œå¦‚æœæˆ‘ä»¬ä¸è¿›è¡Œæˆªå–ï¼Œç›´æ¥å¯¹åº“åè¿›è¡Œçˆ†ç ´ï¼Œå°±è¿œè¿œä¸æ­¢7*62ç§å¯èƒ½ï¼Œè€Œæ˜¯â€œ62çš„ä¸ƒæ¬¡æ–¹â€ä¸ªç»“æœã€‚



### å­—ç¬¦ä¸²çš„æˆªå–

1. **substr	(substringæ˜¯å¦ä¸€ç§å†™æ³•)**

   åœ¨æ•°æ®åº“ä¸­ï¼Œæœ€æœ€æœ€å¸¸ç”¨çš„æ˜¯substrï¼Œè€Œsubstræœ‰ä¸¤ç§å‚æ•°å†™æ³•ï¼Œä¸€ç§æ˜¯`substr(str,pos)`è¿™ç§æ–¹å¼åªèƒ½ä»æŸä¸€ä½å¼€å§‹æˆªå–ï¼Œä¸€ç›´æˆªå–åˆ°æœ€åï¼Œè¿™ä¸ªå°±ä¸å¤Ÿçµæ´»ï¼Œè€Œå¦ä¸€ç§å‚æ•°æ–¹æ³•æ˜¯`substr(str,pos,len)`

   - **`str`**ï¼šè¿™æ˜¯åŸå§‹çš„å­—ç¬¦ä¸²ï¼Œå®ƒå¯ä»¥æ˜¯ä¸€ä¸ªåˆ—åï¼ˆè¡¨ç¤ºä»è¡¨ä¸­çš„æŸä¸€åˆ—è·å–å­—ç¬¦ä¸²ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡ã€‚ä¾‹å¦‚ï¼Œåœ¨æŸ¥è¯¢è¯­å¥`SELECT SUBSTR('abcdef', 3);`ä¸­ï¼Œ`'abcdef'`å°±æ˜¯åŸå§‹å­—ç¬¦ä¸²`str`ã€‚
   - **`pos`**ï¼šè¿™ä¸ªå‚æ•°æŒ‡å®šäº†å¼€å§‹æå–å­å­—ç¬¦ä¸²çš„ä½ç½®ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ MySQL ä¸­ï¼Œå­—ç¬¦ä¸²çš„ä½ç½®ç´¢å¼•æ˜¯ä» 1 å¼€å§‹çš„ï¼Œè€Œä¸æ˜¯ 0ã€‚ä¾‹å¦‚ï¼Œåœ¨`SUBSTR('abcdef', 3)`ä¸­ï¼Œ`pos = 3`ï¼Œè¡¨ç¤ºä»å­—ç¬¦`c`å¼€å§‹æå–ï¼Œæœ€ç»ˆç»“æœä¸º`cdef`ã€‚
   - `len`ï¼šè¿™ä¸ªå‚æ•°æŒ‡å®šäº†é•¿åº¦ï¼Œæ¯”å¦‚`SUBSTR('abcdef', 3, 1)`ä¸­ï¼Œ`len=3`ï¼Œè¡¨ç¤ºä»cå¼€å§‹æˆªå–ï¼Œæˆªå–1ä½ï¼Œæœ€ç»ˆç»“æœ
   - å¦‚æœæˆ‘ä»¬è¢«è¿‡æ»¤äº†é€—å·æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹åŠæ³•`SELECT SUBSTR('2024-12-14', 6, 5);`ä¸`SELECT SUBSTR('2024-12-14' FROM 6 FOR 5)`
   
2. **mid()**

   SQL MID()å‡½æ•°ç”¨äºå¾—åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œåªæœ‰MySQLæ”¯æŒï¼Œä¸è¢« `SQL Server` å’Œ `Oracle`æ”¯æŒï¼Œè€Œåœ¨`SQL Server`å’Œ `Oracle`ä¸­å¯ä»¥ç”¨`SQL SUBSTRING`å‡½æ•°æˆ–è€…SQL `SUBSTR`å‡½æ•°ä½œä¸ºæ›¿ä»£ã€‚æœ‰substré¦–å…ˆsubstrï¼Œæ²¡æœ‰å†ç”¨midæ›¿ä»£

   midå’ŒsubstråŸºæœ¬ç›¸åŒï¼Œä¸åŒç‚¹åœ¨äºä»¥ä¸‹åŒºåˆ«

   - substrä¸­å‚æ•°æ˜¯å¯é€‰çš„ï¼Œä½†midå¿…é¡»æ˜¯3ä¸ªå‚æ•°
   - substræ”¯æŒ`SUBSTRING(str FROM pos FOR len)`æˆ–è€…`SUBSTRING(str FROM pos)`ï¼Œä¸¾ä¾‹å¦‚ä¸Šä¸€æ¡
   
3. **right()**

   ä»å³è¾¹å¼€å§‹æˆªå–ï¼Œå¦‚right('abcde',1)å°±æ˜¯æˆªå–åˆ°ä¸€ä¸ªeï¼Œæ­¤æ—¶å°±ä¸æ˜¯ç²¾ç¡®çš„æˆªå–æŸä¸€ä½çš„ä¸œè¥¿äº†ï¼Œä½†æˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‡½æ•°è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„ã€‚æˆ‘ä»¬ç”¨ä»¥ä¸‹æ­¥éª¤å®ç°

   1. `right('abcdef',1)='a'`ã€`right('abcdef',1)='b'`ã€`right('abcdef',1)='c'`ä¾æ¬¡ç±»æ¨ï¼Œç›´åˆ°æ‰¾åˆ°`f`
   2. ç„¶åæˆ‘ä»¬æˆªä¸¤ä½`right('abcdef',2)='af'`ã€`right('abcdef',2)='bf'`ã€`right('abcdef',2)='cf'`ä¾æ¬¡ç±»æ¨ï¼Œæœ€ç»ˆæ‰¾åˆ°æ˜¯`ef`
   3. æ¥ä¸‹æ¥é€’å½’å¾€å‰æ¨ï¼Œæ¯æ¬¡å¤šæˆª1ä½ï¼Œå¸¦ç€ä¹‹å‰å·²ç»æˆªå–å¥½å¹¶æ¯”è¾ƒé€šè¿‡è¿‡çš„å†…å®¹å»ç»§ç»­æ¯”è¾ƒ

> å…¶å®æˆ‘ä»¬ä¸æ¨èç”¨ç›´æ¥æ¯”è¾ƒå­—ç¬¦çš„æ–¹æ³•ï¼Œå› ä¸ºå¦‚æœç›®æ ‡çš„flagä¸­æœ‰ç‰¹æ®Šå­—ç¬¦å•å¼•å·`'`ï¼Œåœ¨ä½¿ç”¨è¿™ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œå°±ä¼šäº§ç”Ÿå¦‚ä¸‹è¯­å¥ï¼Œå•å¼•å·å¯¼è‡´äº†å‡ºç°äº†è¯­æ³•é”™è¯¯ã€‚
>
> ```
> right(select flag from flag,3) = ''def'
> ```



### ä¸æ˜¯æ¯”è¾ƒå­—ç¬¦çš„è§£å†³æ–¹æ¡ˆ---Asciiç 

asciiç åœ¨ä½¿ç”¨æ—¶ï¼Œä¸€å®šè¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼š97å¯¹åº”çš„aæ˜¯é¦–å­—ç¬¦ï¼Œasciiå‡½æ•°ä¼šè¿”å›é¦–å­—ç¬¦çš„asciiç å€¼

```mysql
mysql> select ascii('abc');
+--------------+
| ascii('abc') |
+--------------+
|           97 |
+--------------+
1 row in set (0.00 sec)
```

æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹å¦‚ä¸‹æƒ…å†µï¼š

```mysql
mysql> select right('abcdef',1);
+-------------------+
| right('abcdef',1) |
+-------------------+
| f                 |
+-------------------+
1 row in set (0.00 sec)

mysql> select right('abcdef',2);
+-------------------+
| right('abcdef',2) |
+-------------------+
| ef                |
+-------------------+
1 row in set (0.00 sec)

mysql> select right('abcdef',3);
+-------------------+
| right('abcdef',3) |
+-------------------+
| def               |
+-------------------+
1 row in set (0.00 sec)
```

ç”±åˆšæ‰çš„æŸ¥è¯¢ç»“æœå¯ä»¥å¾—çŸ¥ï¼Œæˆ‘ä»¬çš„é¦–å­—æ¯æ˜¯ä¸€ç›´åœ¨å˜çš„ï¼Œæˆ‘ä»¬å°†ä»–å¥—è¿›asciiå‡½æ•°é‡Œå»ï¼Œå¾—åˆ°å¦‚ä¸‹ç»“æœï¼š

```mysql
mysql> select ascii(right('abcdef',1));
+--------------------------+
| ascii(right('abcdef',1)) |
+--------------------------+
|                      102 |
+--------------------------+
1 row in set (0.00 sec)

mysql> select ascii(right('abcdef',2));
+--------------------------+
| ascii(right('abcdef',2)) |
+--------------------------+
|                      101 |
+--------------------------+
1 row in set (0.00 sec)

mysql> select ascii(right('abcdef',3));
+--------------------------+
| ascii(right('abcdef',3)) |
+--------------------------+
|                      100 |
+--------------------------+
1 row in set (0.00 sec)
```

