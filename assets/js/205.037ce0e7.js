(window.webpackJsonp=window.webpackJsonp||[]).push([[205],{742:function(s,t,a){"use strict";a.r(t);var n=a(2),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("Boxx"),s._v(" "),t("p",[s._v("从0开始学习CTF，了解CTF基本规则、方法，这是开始打卡学习的第68天")]),s._v(" "),t("p",[s._v("今日内容：算法逆向&散列对称非对称&JS源码逆向&AES&DES&RSA&SHA")]),s._v(" "),t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#一、解密实例-密文存储-数据传输"}},[s._v("一、解密实例-密文存储&数据传输")]),t("ul",[t("li",[t("a",{attrs:{href:"#一-解密实例-后端加密-discuzx32"}},[s._v("（一）解密实例-后端加密-Discuzx32")])]),t("li",[t("a",{attrs:{href:"#二-通过脚本碰撞解密"}},[s._v("（二）通过脚本碰撞解密：")])]),t("li",[t("a",{attrs:{href:"#三-案例演示-后端加密-discuzx35"}},[s._v("（三）案例演示-后端加密-Discuzx35")])]),t("li",[t("a",{attrs:{href:"#四-案例演示-前端加密-zblog"}},[s._v("（四）案例演示-前端加密-zblog")])]),t("li",[t("a",{attrs:{href:"#五-墨者靶场-后端处理"}},[s._v("（五）墨者靶场-后端处理")])]),t("li",[t("a",{attrs:{href:"#六-总结与思考"}},[s._v("（六）总结与思考")])])])]),t("li",[t("a",{attrs:{href:"#思维导图"}},[s._v("思维导图")])])])]),t("p"),s._v(" "),t("ul",[t("li",[s._v("小迪安全视频地址【"),t("RouterLink",{attrs:{to:"/views/numerology/[https://www.bilibili.com/video/BV123yAYMEwb/"}},[s._v("🔗传送门")]),s._v("】")],1)]),s._v(" "),t("h1",{attrs:{id:"第27章-算法逆向-散列对称非对称-js源码逆向-aes-des-rsa-sha"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第27章-算法逆向-散列对称非对称-js源码逆向-aes-des-rsa-sha"}},[s._v("#")]),s._v(" 第27章：算法逆向&散列对称非对称&JS源码逆向&AES&DES&RSA&SHA")]),s._v(" "),t("h2",{attrs:{id:"一、解密实例-密文存储-数据传输"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、解密实例-密文存储-数据传输"}},[s._v("#")]),s._v(" 一、解密实例-密文存储&数据传输")]),s._v(" "),t("p",[s._v("**准备：**Web源码、前端js源码、后端php源码")]),s._v(" "),t("p",[t("strong",[s._v("重点：")])]),s._v(" "),t("ul",[t("li",[s._v("==有密文，有源码直接看源码，分析算法（后端必须要有源码才能彻底清楚知道是怎么加密的）==")]),s._v(" "),t("li",[s._v("==有密文，没有源码，一是靠猜，二是看前端js（加密逻辑是不是在前端）==")])]),s._v(" "),t("h3",{attrs:{id:"一-解密实例-后端加密-discuzx32"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一-解密实例-后端加密-discuzx32"}},[s._v("#")]),s._v(" （一）解密实例-后端加密-Discuzx32")]),s._v(" "),t("p",[s._v("**需求分析：**我们用刚才搭建好的Discuzx32（我重新搭建了Discuzx32，在第二次搭建的时候报错了，一直修复不了），假设我们拿到了数据库权限，从数据库权限找到了账号密码，但账号密码是加密的，我们不知道明文是什么，需要解密。")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/ctfLearn/image-20250127182357950.png",alt:"image-20250127182357950"}})]),s._v(" "),t("p",[s._v("我们看到password的值是"),t("code",[s._v("083fec6b577122a4d58a06a8ef2c2f68")]),s._v("，总共是32位，初步猜测是MD5加密的。")]),s._v(" "),t("p",[s._v("我们用CMD5工具，这个工具常用，需要记住地址，目前是"),t("code",[s._v("www.cmd5.org")]),s._v("，查询后发现需要付费")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/ctfLearn/image-20250127183423459.png",alt:"image-20250127183423459"}})]),s._v(" "),t("p",[s._v("这里即便付费，也应该是缺少salt盐，无法解密，我们考虑一下解密不出来的情况：")]),s._v(" "),t("p",[s._v("已知条件只有一串密文"),t("code",[s._v("083fec6b577122a4d58a06a8ef2c2f68")]),s._v("，通过观察我们发现密码不符合对称加密的AES、DES，或者非对称加密SHA的那种带有+或者/这些符号的特征，是符合MD5特征的。")]),s._v(" "),t("p",[t("strong",[s._v("思路：")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("先分析密文特征，尝试判断密文是什么，然后搜集信息，像数据库里的字段就是重要信息，这里"),t("code",[s._v("pre_ucenter_member")]),s._v("这张表有个字段是salt，这里需要明白这就是MD5加密俗称的盐，即md5(md5('字符串').'固定字符串')；")])]),s._v(" "),t("li",[t("p",[s._v("如果猜不出来，信息也搜集不到，我们只能想办法获取源码，这里我们直接看Discuzx32的源码（位置/upload/uc_server/model/user.php）：")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/ctfLearn/image-20250127192906750.png",alt:"image-20250127192906750"}})])]),s._v(" "),t("li",[t("p",[s._v("这里最重要的是"),t("code",[s._v("$password = md5(md5($password).$salt);")]),s._v("，和正常最简单的md5加密却别在于加了salt盐，然后又做了一次md5加密。")])]),s._v(" "),t("li",[t("p",[s._v("如果明文是"),t("code",[s._v("123456")]),s._v("，salt盐是"),t("code",[s._v("7248a0")]),s._v("，我们尝试用【"),t("a",{attrs:{href:"https://github.com/guyoung/CaptfEncoder",target:"_blank",rel:"noopener noreferrer"}},[s._v("CaptfEncoder"),t("OutboundLink")],1),s._v("】工具去还原一下，看能不能和数据库中的面貌对的上。先对"),t("code",[s._v("123456")]),s._v("进行md5加密，"),t("code",[s._v("e10adc3949ba59abbe56e057f20f883e")]),s._v("，然后拼接"),t("code",[s._v("7248a0")]),s._v("得到"),t("code",[s._v("e10adc3949ba59abbe56e057f20f883e7248a0")]),s._v("，再进行一次md5，最后得到"),t("code",[s._v("083fec6b577122a4d58a06a8ef2c2f68")]),s._v("，发现和数据库中的数据是对的上的。")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/ctfLearn/image-20250127193715182.png",alt:"image-20250127193715182"}})])]),s._v(" "),t("li",[t("p",[s._v("其实我们需要学习的是自己如何写脚本去碰撞，让我们的常用密码字典加密后和数据库中的密码进行碰撞")])])]),s._v(" "),t("h3",{attrs:{id:"二-通过脚本碰撞解密"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二-通过脚本碰撞解密"}},[s._v("#")]),s._v(" （二）通过脚本碰撞解密：")]),s._v(" "),t("p",[s._v("我们用【"),t("a",{attrs:{href:"https://toolin.cn/run-php7",target:"_blank",rel:"noopener noreferrer"}},[s._v("在线PHP运行工具"),t("OutboundLink")],1),s._v("】写一个反向碰撞解密的脚本，视频中代码内容如下：")]),s._v(" "),t("div",{staticClass:"language-php line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token php language-php"}},[t("span",{pre:!0,attrs:{class:"token delimiter important"}},[s._v("<?php")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$password")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'123456'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$salt")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'7248a0'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$a")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("md5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$password")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$aa")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("md5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$a")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$salt")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$aaa")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("md5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$aa")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$result")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'083fec6b577122a4d58a06a8ef2c2f68'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'ok'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'no'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token delimiter important"}},[s._v("?>")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("p",[s._v("我们尝试改进一下，加个循环，让代码读取我们的字典，自动去尝试碰撞：")]),s._v(" "),t("div",{staticClass:"language-php line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token php language-php"}},[t("span",{pre:!0,attrs:{class:"token delimiter important"}},[s._v("<?php")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$password_hash")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'083fec6b577122a4d58a06a8ef2c2f68'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$salt")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'7248a0'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 你的密码字典数组")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$passwords")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'admin'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'88888888'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'123456'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("foreach")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$passwords")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$password")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 计算当前密码的哈希值")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$result")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("md5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("md5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$password")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$salt")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 检查哈希值是否匹配")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$result")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$password_hash")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$password")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("' is right'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("break")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 找到密码后退出循环")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token delimiter important"}},[s._v("?>")])]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br")])]),t("p",[s._v("从这个代码中我们要学到在PHP中怎么用循环语句，此外我们还用Python代码写了一下（用GPT生成的，以后少生成，多练代码）")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" hashlib\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 目标哈希值")]),s._v("\npassword_hash "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'083fec6b577122a4d58a06a8ef2c2f68'")]),s._v("\nsalt "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'7248a0'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从 txt 文件读取字典")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("read_dictionary")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("file_path"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("open")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("file_path"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'r'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" f"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("line"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("strip"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" line "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" f"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("readlines"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 计算密码哈希值并进行比较")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("check_password")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dictionary"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" password "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" dictionary"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 第一次 MD5 加密，获取十六进制字符串结果")]),s._v("\n        first_md5_hex "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hashlib"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("md5"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("password"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("encode"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'utf-8'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hexdigest"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将第一次 MD5 加密的十六进制字符串和盐值拼接")]),s._v("\n        combined "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" first_md5_hex "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" salt\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对拼接后的字符串进行第二次 MD5 加密")]),s._v("\n        second_md5 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hashlib"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("md5"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("combined"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("encode"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'utf-8'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hexdigest"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 检查哈希值是否匹配")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" second_md5 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" password_hash"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string-interpolation"}},[t("span",{pre:!0,attrs:{class:"token string"}},[s._v("f'Password \"")]),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("password"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\" is correct.'")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" password  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 找到正确的密码后返回")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Password not found in dictionary."')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("None")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置字典文件路径")]),s._v("\nfile_path "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'dictionary.txt'")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改为你的字典文件路径")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 读取字典并进行检查")]),s._v("\npasswords "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" read_dictionary"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("file_path"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ncheck_password"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("passwords"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br")])]),t("p",[s._v("**总结：**CMD5那个平台的原理其实应该也是和我们一样的，都是用现有的密码字典加密后去和密文碰撞")]),s._v(" "),t("h3",{attrs:{id:"三-案例演示-后端加密-discuzx35"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三-案例演示-后端加密-discuzx35"}},[s._v("#")]),s._v(" （三）案例演示-后端加密-Discuzx35")]),s._v(" "),t("p",[s._v("我们用到昨天搭建过的Discuzx35，直接查看数据库"),t("code",[s._v("ultrax35")]),s._v("这个数据库中的"),t("code",[s._v("pre_ucenter_members")]),s._v("这张表")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/ctfLearn/image-20250127204630634.png",alt:"image-20250127204630634"}})]),s._v(" "),t("p",[t("strong",[s._v("思路：")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("观察这个密文"),t("code",[s._v("$2y$10$jnRkfdXYyZmuCbvxtX7Wfu6pK2Hhtu8ipY98TJPzjVPaoQufQEUvq")]),s._v("，我们发现有很多其他符号。没有源码我们就猜，有源码我们就看源码。")])]),s._v(" "),t("li",[t("p",[s._v("我们课程里学开发就是学框架，当我们要在源码里找什么东西，能直接找到。这里我们看源码（位置/upload/uc_server/model/user.php）：")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/ctfLearn/image-20250127210125634.png",alt:"image-20250127210125634"}})])]),s._v(" "),t("li",[t("p",[s._v("代码中用到了"),t("code",[s._v("password_hash()")]),s._v("函数，我们用"),t("a",{attrs:{href:"https://baike.baidu.com/item/password_hash/17652980",target:"_blank",rel:"noopener noreferrer"}},[s._v("百度百科"),t("OutboundLink")],1),s._v("查阅函数相关资料，大概就是创建一个密码散列，也类似于MD5，这里我们用【"),t("a",{attrs:{href:"https://www.runoob.com/php/php-password_hash.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("菜鸟教程"),t("OutboundLink")],1),s._v("】查看相关用法")])]),s._v(" "),t("li",[t("p",[s._v("这里演示的用法和我们数据库中最终的密文结构组成、长度类似")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/ctfLearn/image-20250127211321974.png",alt:"image-20250127211321974"}})])]),s._v(" "),t("li",[t("p",[s._v("这里我们换了一种思路，用以下代码在【"),t("a",{attrs:{href:"https://toolin.cn/run-php7",target:"_blank",rel:"noopener noreferrer"}},[s._v("在线PHP运行工具"),t("OutboundLink")],1),s._v("】中执行，用的是password_verify这个解密函数")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("<?php\n$hash = '$2y$10$jnRkfdXYyZmuCbvxtX7Wfu6pK2Hhtu8ipY98TJPzjVPaoQufQEUvq';\nif(password_verify('123456',$hash)){\n    echo 'ok';\n}else{\n    echo 'error';\n}\n?>\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("这种加密方式是单向加密，是没有逆向的算法的，只能去碰撞。如果密码错误就是error，密码正确就是ok")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("password_hash")]),s._v("这种方式是PHP内置的方法， 像是在CMD5上边是没有的，也是解密不出来的，只能用"),t("code",[s._v("password_verify")]),s._v("这个函数去验证、碰撞。")])])]),s._v(" "),t("h3",{attrs:{id:"四-案例演示-前端加密-zblog"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四-案例演示-前端加密-zblog"}},[s._v("#")]),s._v(" （四）案例演示-前端加密-zblog")]),s._v(" "),t("p",[s._v("这里用到了前几节课部署的zblog，进入登录界面，查看登录按钮的源代码：")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/ctfLearn/image-20250127220127255.png",alt:"image-20250127220127255"}})]),s._v(" "),t("p",[s._v("这里的js部分写到了md5加密算法，截图可能没截到，然后有个md5.js的js文件被引用了，所以用到的就是md5加密。")]),s._v(" "),t("p",[s._v("我们尝试输入一个账号admin，密码123456，用开发者工具F12查看NetWork，看到有一个请求被发出去了：")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/ctfLearn/image-20250127220523440.png",alt:"image-20250127220523440"}})]),s._v(" "),t("h3",{attrs:{id:"五-墨者靶场-后端处理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#五-墨者靶场-后端处理"}},[s._v("#")]),s._v(" （五）墨者靶场-后端处理")]),s._v(" "),t("p",[s._v("我们用【"),t("a",{attrs:{href:"https://mozhe.cn/bug/detail/110",target:"_blank",rel:"noopener noreferrer"}},[s._v("墨者靶场"),t("OutboundLink")],1),s._v("】这个平台，打开"),t("code",[s._v("SQL注入漏洞测试（参数加密）")]),s._v("这个靶场，编号为110")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/ctfLearn/image-20250127222012865.png",alt:"image-20250127222012865"}})]),s._v(" "),t("p",[s._v("点击进入靶场，看到有个输入账号密码的网站，注意到下方有个公告：")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/ctfLearn/image-20250127222216895.png",alt:"image-20250127222216895"}})]),s._v(" "),t("p",[s._v("进入这个公告，我们发现地址是一个id="),t("code",[s._v("xx")]),s._v("的形式，像是base64编码的，我们尝试解密：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("http://124.70.71.251:47629/news/list.php?id=ZUlJOGMzSmVMMHQwZHhNN3diM056Zz09\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"/img/ctfLearn/image-20250127222348657.png",alt:"image-20250127222348657"}})]),s._v(" "),t("p",[s._v("解密得到"),t("code",[s._v("eII8c3JeL0t0dxM7wb3Nzg==")]),s._v("，又像是base64，继续解密发现是"),t("code",[s._v("x�<sr^/Ktw;����")]),s._v("，这就意味着我们是错的，不是Base64编码的。")]),s._v(" "),t("p",[s._v("我们观察这个地址，尝试看"),t("code",[s._v("http://124.70.71.251:47629/news/")]),s._v("这个地址下有没有其他东西，发现可以访问且有个压缩包")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/ctfLearn/image-20250127222718860.png",alt:"image-20250127222718860"}})]),s._v(" "),t("p",[s._v("我们下载这个压缩包，发现是题目给的源代码：")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/ctfLearn/image-20250127222905577.png",alt:"image-20250127222905577"}})]),s._v(" "),t("p",[s._v("这里重点是"),t("code",[s._v("mcrypt_module_open")]),s._v("这个函数，我们搜索发现这个AES的算法，得到如下信息：")]),s._v(" "),t("ul",[t("li",[s._v("AES128加密")]),s._v(" "),t("li",[s._v("CBC模式")]),s._v(" "),t("li",[s._v("Key密钥是"),t("code",[s._v("ydhaqPQnexoaDuW3")])]),s._v(" "),t("li",[s._v("iv偏移量是"),t("code",[s._v("2018201920202021")])])]),s._v(" "),t("p",[s._v("这时我们重新用【"),t("a",{attrs:{href:"https://github.com/guyoung/CaptfEncoder",target:"_blank",rel:"noopener noreferrer"}},[s._v("CaptfEncoder"),t("OutboundLink")],1),s._v("】工具去尝试解密，通过查看源码，第是经过两次Base64才解开的密文，所以这里我们需要先用Base64解一次以后，再用AES的Base64格式再解一次。")]),s._v(" "),t("div",{staticClass:"language-php line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$data")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mdecrypt_generic")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$td")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("base64_decode")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("base64_decode")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$data")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("第一次Base64解码还是得到"),t("code",[s._v("eII8c3JeL0t0dxM7wb3Nzg==")]),s._v("，然后我们在此基础上再去AES-128解密（需要注意要用ZeroPadding的模式）：")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/ctfLearnimage-20250127223927391.png",alt:"image-20250127223927391"}})]),s._v(" "),t("p",[s._v("最后得到"),t("code",[s._v("1_mozhe")]),s._v("这个明文。")]),s._v(" "),t("p",[s._v("题目后续就是注入漏洞利用，这里就需要我们把SQL注入语句按照刚才的逻辑去加密以后再请求")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("-1 union select 1,database(),user(),4_mozhe\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("先用AES-128加密得到"),t("code",[s._v("xgd58ipTrnx8VzSBJicqCibZxIRsZKgXOYUrNQP8fCCtx9JZ+6K1hHt7RKkzV305")]),s._v("，然后再用Base64编码得到"),t("code",[s._v("eGdkNThpcFRybng4VnpTQkppY3FDaWJaeElSc1pLZ1hPWVVyTlFQOGZDQ3R4OUpaKzZLMWhIdDdSS2t6VjMwNQ==")])]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/ctfLearn/image-20250127224638842.png",alt:"image-20250127224638842"}})]),s._v(" "),t("p",[s._v("我们用生成好的密文，去替换刚才访问地址的id值，最后得到访问地址：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("http://124.70.71.251:47629/news/list.php?id=eGdkNThpcFRybng4VnpTQkppY3FDaWJaeElSc1pLZ1hPWVVyTlFQOGZDQ3R4OUpaKzZLMWhIdDdSS2t6VjMwNQ==\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"/img/ctfLearn/image-20250127224757599.png",alt:"image-20250127224757599"}})]),s._v(" "),t("p",[s._v("根据图中显示我们知道了数据库名是"),t("strong",[s._v("mozhe_Discuz_StormGroup")]),s._v("，密码是"),t("code",[s._v("root@localhost")]),s._v("。")]),s._v(" "),t("p",[s._v("后续我猜可以用注入漏洞找到用户名密码，然后登录进去即可")]),s._v(" "),t("h3",{attrs:{id:"六-总结与思考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#六-总结与思考"}},[s._v("#")]),s._v(" （六）总结与思考")]),s._v(" "),t("p",[s._v("以上两个实例相对来说都是比较安全的，都是单向加密，我们只能去碰撞，没办法根据算法逆向得到明文的。")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("密码存储（后端处理）")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("discuzx3.2用到的是md5&salt的加密方式")]),s._v(" "),t("p",[s._v("对应的代码段./upload/uc_server/model/user.php")]),s._v(" "),t("div",{staticClass:"language-php line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" add_user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$password")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("md5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("md5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$password")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$salt")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("这种必须要我们正向的用明文加密后碰撞")])]),s._v(" "),t("li",[t("p",[s._v("disuczx3.5用到的是PHP自带的Hash处理")]),s._v(" "),t("p",[s._v("对应的代码段./upload/uc_server/model/user.php")]),s._v(" "),t("div",{staticClass:"language-php line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-php"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-definition function"}},[s._v("generate_password")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$password")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$algo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$this")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_passwordalgo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$options")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$this")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_passwordoptions")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$hash")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("password_hash")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$password")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$algo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$options")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$hash")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword type-declaration"}},[s._v("false")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$hash")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword type-declaration"}},[s._v("null")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("password_verify")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$password")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$hash")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("password_hash")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$password")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PASSWORD_BCRYPT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$hash")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("这种就需要我们用PHP自带的"),t("code",[s._v("password_verify")]),s._v("函数去做验证、碰撞")])]),s._v(" "),t("li",[t("p",[s._v("以上都是后端的加密，没有这套源码，我们是不知道怎么去加密的，只能靠猜。")])]),s._v(" "),t("li",[t("p",[s._v("js前端那种就是浏览器可以看到源代码的。")])])])]),s._v(" "),t("li",[t("p",[s._v("数据通讯（前端处理）")]),s._v(" "),t("ol",[t("li",[t("ul",[t("li",[t("p",[s._v("博客登录-zblog")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("script src"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/script/md5.js"')]),s._v(" type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text/javascript"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("script"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*Script for KandyEntry by jgpy.cn*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" $label "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"form"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"label"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"form"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("submit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" me "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t$btn "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"button"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("prop")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"disabled"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("addClass")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"loading"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("text")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'提交中'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\t$"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("post")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("action"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("serialize")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("replace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password="')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("password"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password="')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MD5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("password"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"&ajax=1&dishtml5="')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("window"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("applicationCache "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"button"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("prop")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"disabled"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])])])])])])]),s._v(" "),t("li",[t("p",[s._v("墨者学院靶场-SQL注入漏洞")]),s._v(" "),t("ul",[t("li",[s._v("这道题告诉我们这些加密算法会对我们漏洞测试带来的影响")]),s._v(" "),t("li",[s._v("能不能进行漏洞测试，就是看算法能不能逆向出来，能不能逆向要看算法的种类，而算法类型决定了我们需要什么条件，比如刚才的Cipher Mode这种加解密时候参数。")]),s._v(" "),t("li",[s._v("==看密文->猜加密算法->猜不出->找源码->没有源码看js有没有泄露加密算法==")])])])]),s._v(" "),t("h2",{attrs:{id:"思维导图"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#思维导图"}},[s._v("#")]),s._v(" 思维导图")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/ctfLearn/image-20250127231223457.png",alt:"image-20250127231223457"}})])],1)}),[],!1,null,null,null);t.default=e.exports}}]);